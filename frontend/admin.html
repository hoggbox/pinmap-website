<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - Milledgeville Alert Map</title>
  <link rel="stylesheet" href="css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app">
    <header>
      <h1>Admin Panel - Milledgeville Alert Map</h1>
    </header>
    <div class="admin-container" id="admin-container">
      <div class="controls">
        <button onclick="window.location.href='index.html'">Back to Map</button>
        <button onclick="window.location.href='online.html'">Online Users</button>
        <button onclick="signOut()">Sign Out</button>
        <button onclick="exportToCSV()">Export to CSV</button>
      </div>
      <div class="admin-section">
        <h2>User Management</h2>
        <div class="filter-container">
          <label for="user-filter">Filter Users: </label>
          <select id="user-filter">
            <option value="all">All Users</option>
            <option value="newest">Newest First</option>
            <option value="oldest">Oldest First</option>
            <option value="active">Active (Last 30 Days)</option>
            <option value="highActivity">High Activity (>10 Pins)</option>
            <option value="banned">Banned Users</option>
          </select>
          <label for="user-search">Search: </label>
          <input type="text" id="user-search" placeholder="Email or Username">
          <button onclick="fetchUsers()">Search</button>
        </div>
        <div class="bulk-actions">
          <button onclick="deleteSelected()">Delete Selected</button>
          <button onclick="banSelected()">Ban Selected IPs</button>
        </div>
        <div id="user-list"></div>
        <div id="analytics-chart">
          <h3>User Registration Trends</h3>
          <canvas id="registration-chart"></canvas>
        </div>
      </div>
      <div class="admin-section" id="user-pins-section" style="display: none;">
        <h2>User Alerts</h2>
        <button onclick="closeUserPins()">Back to Users</button>
        <div id="user-pins-list"></div>
      </div>
    </div>
    <div id="activity-modal" class="modal" style="display: none;">
      <div class="modal-content">
        <h2>User Activity</h2>
        <p><strong>Email:</strong> <span id="modal-email"></span></p>
        <p><strong>Total Pins:</strong> <span id="modal-pins"></span></p>
        <p><strong>Last Login:</strong> <span id="modal-last-login"></span></p>
        <p><strong>Account Age:</strong> <span id="modal-age"></span> days</p>
        <button onclick="closeModal()">Close</button>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/admin.js"></script>
</body>
</html>